# ISCP_SOC CHALL
Usage - python3 detector_full_candidate_name.py iscp_pii_dataset.csv

# Project Guardian 2.0 – Deployment Strategy

## Objective
The goal of **Project Guardian 2.0** is to roll out a **real-time PII (Personally Identifiable Information) Detector & Redactor** that safeguards customer data across Flixkart’s ecosystem.  

Specifically, the system should:  
- Catch and sanitize sensitive data in **logs and API payloads** before it’s stored or shared.  
- Stop PII leaks from **unmonitored services, API integrations, and internal tools**.  
- Do this while staying **fast, scalable, and cost-efficient**.  

---

## Deployment Layers Considered

### 1. **API Gateway Plugin**
- **Why here?**  
  Most PII leaks start in API payloads or logs. The API gateway is a natural choke point—every external API call flows through it. If we intercept here, we can redact data *before* it’s logged or sent downstream.  

- **How it works**  
  - Build a PII Detector plugin for **Kong, NGINX, or Envoy API Gateway**.  
  - Scan incoming/outgoing JSON payloads in-stream.  
  - Use regex + lightweight NER to keep processing time under **5ms per request**.  

- **Benefits**  
  - Protection happens immediately at the point of entry/exit.  
  - Scales by simply adding more gateway nodes.  
  - Microservices stay untouched—enforcement is centralized.  

---

### 2. **Sidecar Container (Per Microservice)**
- **Why here?**  
  Sometimes sensitive data leaks from inside—through logs generated by microservices. A sidecar ensures every log line or event is filtered before leaving the pod.  

- **How it works**  
  - Deploy a **DaemonSet in Kubernetes** or run a sidecar container alongside each app pod.  
  - The sidecar intercepts stdout/stderr logs, scrubs PII, and forwards clean logs to **ELK, Datadog, or Splunk**.  

- **Benefits**  
  - Stops accidental developer log statements from exposing PII.  
  - Easy to roll out to new services (the sidecar pattern repeats cleanly).  

- **Trade-off**  
  - Higher CPU/memory usage since each pod carries an extra container.  

---

### 3. **Internal Tooling Integration**
- **Why here?**  
  PII often creeps into **support dashboards, admin portals, or BI tools**. Filtering before rendering prevents insider exposure and accidental leaks.  

- **How it works**  
  - Embed the PII Detector as middleware in frameworks like **Django, Flask, or Node.js**.  
  - Redaction happens at the application layer, so sensitive fields are masked before staff see them.  

---

## Recommended Hybrid Approach
No single layer is enough. The best approach is **layered protection**:  

- **API Gateway Plugin** → First line of defense for external traffic.  
- **Sidecar Container** → Keeps logs and event streams clean.  
- **Middleware Library** → Redundancy for internal dashboards and tools.  

This way, we cover all angles:  
- External API traffic   
- Internal microservice logs 
- Admin dashboards & tools 

---

## Scalability & Cost Considerations
- **Scalability**: All components are stateless, so horizontal scaling is straightforward.  
- **Latency**: Lightweight regex + NER keeps detection fast (~5ms per payload).  
- **Cost**: By focusing on gateways and sidecars (instead of modifying everything), we avoid major infra overhauls.  
- **Integration**: Works with minimal changes—most enforcement happens at choke points.  

---

## Future Enhancements
1. **Smarter ML Models** – move beyond regex, training hybrid ML/NER models on Flixkart’s data patterns.  
2. **Streaming Redaction** – integrate directly with **Kafka/Fluentd** for real-time high-throughput sanitization.  
3. **Audit Dashboard** – build visibility with stats on redactions, false positives, and top sources of leaks.  

---

## Conclusion
By placing the PII Detector at **key interception points**, we create a layered shield against leaks:  
- **API Gateway** for traffic,  
- **Sidecars** for logs,  
- **Middleware** for internal tools.  

This design balances **speed, scalability, and cost-efficiency** while ensuring strong defense-in-depth for Flixkart’s customer data.

- **API Gateway (primary enforcement)**  
- **Sidecars (log scrubbing)**  
- **Middleware (internal UI protection)**  

This layered approach balances **latency, scalability, and cost-effectiveness**, while providing defense-in-depth against PII leaks in Flixkart’s ecosystem.

